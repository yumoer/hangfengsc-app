(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"1b4e":function(t,e,r){"use strict";r.r(e);var a=r("f6a0"),n=r("ed39");for(var o in n)"default"!==o&&function(t){r.d(e,t,function(){return n[t]})}(o);r("d096");var i,s=r("f0c5"),u=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"9ee5b276",null,!1,a["a"],i);e["default"]=u.exports},"4ce2":function(t,e,r){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(r("a34a")),o=s(r("2fb7")),i=(s(r("318c")),r("2f62"));s(r("1b4e"));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e,r,a,n,o,i){try{var s=t[o](i),u=s.value}catch(d){return void r(d)}s.done?e(u):Promise.resolve(u).then(a,n)}function d(t){return function(){var e=this,r=arguments;return new Promise(function(a,n){var o=t.apply(e,r);function i(t){u(o,a,n,i,s,"next",t)}function s(t){u(o,a,n,i,s,"throw",t)}i(void 0)})}}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},a=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),a.forEach(function(e){l(t,e,r[e])})}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(){return r.e("components/uni-section/uni-section").then(r.bind(null,"df1d"))},p=function(){return r.e("components/uni-load-more/uni-load-more").then(r.bind(null,"e0f5"))},g=function(){return r.e("components/min-badge/min-badge").then(r.bind(null,"ba94"))},h=function(){return r.e("components/empty").then(r.bind(null,"5523"))},v={components:{uniLoadMore:p,empty:h,minBadge:g,uniSection:f},data:function(){return{modalTitle:"退/换货",tabCurrentIndex:0,orderList:[],orderId:null,navList:[{state:0,text:"全部",loadingType:"loading",orderList:[]},{state:1,text:"待付款",loadingType:"loading",orderList:[]},{state:2,text:"待发货",loadingType:"loading",orderList:[]},{state:3,text:"待收货",loadingType:"loading",orderList:[]},{state:4,text:"待评价",loadingType:"loading",orderList:[]},{state:5,text:"已完成",loadingType:"loading",orderList:[]}]}},computed:c({},(0,i.mapState)(["userInfo"])),onLoad:function(e){this.tabCurrentIndex=+e.state,t("log",this.tabCurrentIndex,e.state," at pages\\order\\order.vue:199"),0==+e.state?this.loadData("tabChange","全部"):1===+e.state?this.loadData("tabChange","待支付"):2===+e.state?this.loadData("tabChange","待发货"):3===+e.state?this.loadData("tabChange","待收货"):4===+e.state?this.loadData("tabChange","待评价"):5===+e.state&&this.loadData("tabChange","已完成")},onShow:function(){},methods:{loadData:function(t,e){var r=this.tabCurrentIndex,a=this.navList[r];a.state;"tabChange"===t&&!0===a.loaded||"loading"!==a.loadingType||this.getDate(e)},setData:function(e){t("log",e," at pages\\order\\order.vue:241");var r=getCurrentPages();r[r.length-1];1==e.isDoRefresh&&(e.isDoRefresh=!1,0===this.tabCurrentIndex?this.getDate("全部"):4===this.tabCurrentIndex&&this.getDate("待评价"))},getDate:function(){var e=d(n.default.mark(function e(r){var i,s,u,d=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.orderList=[],i=this.tabCurrentIndex,s=this.navList[i],u=s.state,e.next=6,(0,o.default)({url:"/orders/info/?status="+r,method:"get",headers:{Authorization:"JWT "+a.getStorageSync("userInfo").token}}).then(function(e){if(200===e.status){t("log",e.data.order_id," at pages\\order\\order.vue:269"),void 0===e.data.order_id.goods&&(s.orderList=[]);var r=e.data.order_id;for(var a in r)d.orderList.push(r[a]);setTimeout(function(){var t=d.orderList.filter(function(t){return"全部"===t.status?t.state=0:"待支付"===t.status?t.state=1:"待发货"===t.status?t.state=2:"待收货"===t.status?t.state=3:"待评价"===t.status?t.state=4:"已完成"===t.status?t.state=5:"已取消"===t.status&&(t.state=9),t=Object.assign(t,d.orderStateExp(t.state)),0===u?t:t.state});t.forEach(function(t){s.orderList.push(t)}),d.$set(s,"loaded",!0),s.loadingType="nomore"},10)}}).catch(function(e){t("log",e," at pages\\order\\order.vue:315")});case 6:e.sent;case 7:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),changeTab:function(t){this.tabCurrentIndex=t.target.current,0===this.tabCurrentIndex?this.getDate("全部"):1===this.tabCurrentIndex?this.getDate("待支付"):2===this.tabCurrentIndex?this.getDate("待发货"):3===this.tabCurrentIndex?this.getDate("待收货"):4===this.tabCurrentIndex?this.getDate("待评价"):5===this.tabCurrentIndex&&this.getDate("已完成")},tabClick:function(e){t("log",e," at pages\\order\\order.vue:338"),this.tabCurrentIndex=e},payOrder:function(){var e=d(n.default.mark(function e(r){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t("log",r.pay_method_id," at pages\\order\\order.vue:343"),this.orderId=r.order_id,2!==r.pay_method_id){e.next=7;break}return e.next=5,(0,o.default)({url:"orders/app/"+this.orderId+"/payment/",method:"get",headers:{Authorization:"JWT "+a.getStorageSync("userInfo").token}}).then(function(e){t("log",e.data," at pages\\order\\order.vue:354");var r=e.data.message;t("log",r," at pages\\order\\order.vue:357"),a.requestPayment({provider:"alipay",orderInfo:r,success:function(t){a.showToast({title:"支付成功"}),a.switchTab({url:"/pages/user/user"})},fail:function(e){t("log",e,e.errMsg," at pages\\order\\order.vue:370"),a.showModal({content:"抱歉，您的支付不成功",showCancel:!1})}})}).catch(function(e){t("log",e.data," at pages\\order\\order.vue:379")});case 5:e.next=11;break;case 7:if(8!==r.pay_method_id){e.next=11;break}return t("log",a.getStorageSync("userInfo").token," at pages\\order\\order.vue:396"),e.next=11,(0,o.default)({url:"/orders/wechat/app/"+this.orderId+"/payment/",method:"get",headers:{Authorization:"JWT "+a.getStorageSync("userInfo").token}}).then(function(e){t("log",e.data," at pages\\order\\order.vue:404");var r={appid:e.data.appid,noncestr:e.data.noncestr,package:e.data.package,partnerid:e.data.partnerid,prepayid:e.data.prepayid,timestamp:e.data.timestamp,sign:e.data.sign};t("log",JSON.stringify(r)," at pages\\order\\order.vue:416"),a.getProvider({service:"payment",success:function(e){t("log",e.provider," at pages\\order\\order.vue:420"),~e.provider.indexOf("wxpay")&&a.requestPayment({provider:"wxpay",orderInfo:JSON.stringify(r),success:function(t){a.showToast({title:"支付成功"}),a.switchTab({url:"/pages/user/user"})},fail:function(e){t("log",e,e.errMsg," at pages\\order\\order.vue:434"),a.showModal({content:"抱歉，您的支付不成功",showCancel:!1})}})}})}).catch(function(e){t("log",e.data," at pages\\order\\order.vue:446")});case 11:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),deleteOrder:function(t){var e=this;a.showLoading({title:"请稍后"}),setTimeout(function(){e.navList[e.tabCurrentIndex].orderList.splice(t,1),a.hideLoading()},600)},replaceGoods:function(e){t("log",e," at pages\\order\\order.vue:477"),a.navigateTo({url:"/pages/order/lookDetails/concalShops?item="+JSON.stringify(e)+"?order_id="+order_id})},lookDetails:function(){var e=d(n.default.mark(function e(r,o){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t("log",o," at pages\\order\\order.vue:485"),t("log",r," at pages\\order\\order.vue:487"),a.navigateTo({url:"/pages/order/lookDetails/lookDetails?item="+JSON.stringify(r)+"&order_id="+o});case 3:case"end":return e.stop()}},e,this)}));function r(t,r){return e.apply(this,arguments)}return r}(),lookViewOrder:function(){var e=d(n.default.mark(function e(r){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.navigateTo({url:"/pages/order/trackInfo/trackInfo?order_id="+r.order_id}),t("log",r," at pages\\order\\order.vue:497");case 2:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),confirmOrder:function(){var e=d(n.default.mark(function e(r){var i=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t("log",r," at pages\\order\\order.vue:502"),a.showLoading({title:"请稍后"}),e.next=4,(0,o.default)({url:"orders/update/status/",method:"post",data:{order_id:r.order_id},headers:{Authorization:"JWT "+a.getStorageSync("userInfo").token}}).then(function(e){200===e.status&&(t("log",e," at pages\\order\\order.vue:517"),e.data.order_id===r.order_id&&setTimeout(function(){var t=i.orderStateExp(4),e=t.stateTip,n=t.stateTipColor;r=Object.assign(r,{state:4,stateTip:e,stateTipColor:n}),3===i.tabCurrentIndex?(i.getDate("待收货"),i.$api.msg("收货成功"),a.hideLoading()):0===i.tabCurrentIndex&&(i.getDate("全部"),i.$api.msg("收货成功"),a.hideLoading())},600))}).catch(function(t){});case 4:e.sent;case 5:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),cancelOrder:function(){var e=d(n.default.mark(function e(r){var i=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t("log",r," at pages\\order\\order.vue:549"),a.showLoading({title:"请稍后"}),e.next=4,(0,o.default)({url:"/orders/cancel/?order_id="+r.order_id,method:"get",headers:{Authorization:"JWT "+a.getStorageSync("userInfo").token}}).then(function(t){if(t.data.massage){if(i.$api.msg(t.data.massage),"该订单不支持直接取消"===t.data.massage)return;0===i.tabCurrentIndex?i.getDate("全部"):setTimeout(function(){var t=i.orderStateExp(9),e=t.stateTip,n=t.stateTipColor;r=Object.assign(r,{state:9,stateTip:e,stateTipColor:n}),1===i.tabCurrentIndex?i.getDate("待支付"):i.getDate("待发货"),a.hideLoading()},600)}}).catch(function(t){});case 4:e.sent;case 5:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),accessOrder:function(t,e){t.orderId=e,a.navigateTo({url:"/pages/order/assess/assess?item="+JSON.stringify(t)})},orderStateExp:function(t){var e="",r="#fa436a";switch(+t){case 1:e="待付款";break;case 2:e="待发货";break;case 3:e="待收货";break;case 4:e="待评价";break;case 5:e="已完成";break;case 9:e="订单已关闭",r="#909399";break}return{stateTip:e,stateTipColor:r}}}};e.default=v}).call(this,r("0de9")["default"],r("6e42")["default"])},"4de0":function(t,e,r){"use strict";var a=r("4ea7"),n=r.n(a);n.a},"4ea7":function(t,e,r){},"60f2":function(t,e,r){"use strict";(function(t){r("a8bd"),r("921b");a(r("66fd"));var e=a(r("b215"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,r("6e42")["createPage"])},b215:function(t,e,r){"use strict";r.r(e);var a=r("c59c"),n=r("c121");for(var o in n)"default"!==o&&function(t){r.d(e,t,function(){return n[t]})}(o);r("4de0");var i,s=r("f0c5"),u=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],i);e["default"]=u.exports},c121:function(t,e,r){"use strict";r.r(e);var a=r("4ce2"),n=r.n(a);for(var o in a)"default"!==o&&function(t){r.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},c59c:function(t,e,r){"use strict";var a={"uni-load-more":()=>r.e("components/uni-load-more/uni-load-more").then(r.bind(null,"e0f5"))},n=function(){var t=this,e=t.$createElement;t._self._c},o=[];r.d(e,"b",function(){return n}),r.d(e,"c",function(){return o}),r.d(e,"a",function(){return a})},cf3e:function(t,e,r){},d096:function(t,e,r){"use strict";var a=r("cf3e"),n=r.n(a);n.a},ed39:function(t,e,r){"use strict";r.r(e);var a=r("f7c4"),n=r.n(a);for(var o in a)"default"!==o&&function(t){r.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},f6a0:function(t,e,r){"use strict";var a,n=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.clickMask&&t.closeModal()})},o=[];r.d(e,"b",function(){return n}),r.d(e,"c",function(){return o}),r.d(e,"a",function(){return a})},f7c4:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{showModal:!1}},props:{modalTitle:{type:String,default:""},showButton:{type:Boolean,default:!0},shadow:{type:Boolean,default:!0},clickMask:{type:Boolean,default:!0},sureText:{type:String,default:"确定"},cancelText:{type:String,default:"取消"},sureButton:{type:Boolean,default:!0},cancelButton:{type:Boolean,default:!0}},methods:{close:function(){this.$emit("cancelModal"),this.closeModal()},confirm:function(){this.$emit("confirmModal"),this.closeModal()},closeModal:function(){this.showModal=!1},show:function(){this.showModal=!0}}};e.default=a}},[["60f2","common/runtime","common/vendor"]]]);