(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/product"],{"63cb":function(e,t,n){"use strict";n.r(t);var r=n("e63f"),a=n("fdea");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n("67d1");var s,u=n("f0c5"),o=Object(u["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],s);t["default"]=o.exports},"67d1":function(e,t,n){"use strict";var r=n("b91e"),a=n.n(r);a.a},"717c":function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("a34a")),i=o(n("ae0b")),s=n("2f62"),u=o(n("2fb7"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){l(e,t,n[t])})}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,r,a,i,s){try{var u=e[i](s),o=u.value}catch(c){return void n(c)}u.done?t(o):Promise.resolve(o).then(r,a)}function p(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){d(i,r,a,s,u,"next",e)}function u(e){d(i,r,a,s,u,"throw",e)}s(void 0)})}}var h=function(){return Promise.all([n.e("common/vendor"),n.e("components/share")]).then(n.bind(null,"5c8f"))},f=function(){return n.e("components/min-badge/min-badge").then(n.bind(null,"ba94"))},g=function(){return n.e("components/uni-number-box/uni-number-box").then(n.bind(null,"717f"))},m={components:{shares:h,uniNumberBox:g,minBadge:f},data:function(){return{specClass:"none",specSelected:[],detailsArr:{},favorite:!0,shareList:[],imgList:[],subText:"完成",count:1,value:1,min:0,max:3,specList:[],specChildList:[],sku_id:"",num:0,results:[],username:e.getStorageSync("userInfo").username,headPicValue:"",score:0,tip:"市场价",text:"即将开抢",disabled:!0,shareObj:{shareMenu:""}}},filters:{formatRichText:function(e){r("log",e," at pages\\product\\product.vue:248");var t=e.replace(/<img[^>]*>/gi,function(e,t){return e=e.replace(/style="[^"]+"/gi,"").replace(/style='[^']+'/gi,""),e=e.replace(/width="[^"]+"/gi,"").replace(/width='[^']+'/gi,""),e=e.replace(/height="[^"]+"/gi,"").replace(/height='[^']+'/gi,""),e});return t=t.replace(/style="[^"]+"/gi,function(e,t){return e=e.replace(/width:[^;]+;/gi,"max-width:100%;").replace(/width:[^;]+;/gi,"max-width:100%;"),e}),t=t.replace(/<br[^>]*\/>/gi,""),t=t.replace(/\<img/gi,'<img style="max-width:100%;height:auto;display:inline-block;margin:10rpx auto;"'),t}},onShow:function(){e.getStorageSync("userInfo").token&&(this.headPicValue="http://img.zcool.cn/community/01786557e4a6fa0000018c1bf080ca.png")},onBackPress:function(){if(this.shareObj.shareMenu)return this.shareObj.shareMenu.hide(),this.shareObj.alphaBg.hide(),!0},onLoad:function(){var t=p(a.default.mark(function t(n){var i,s=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r("log",n," at pages\\product\\product.vue:282"),i=n.id,this.sku_id=i,r("log",this.sku_id," at pages\\product\\product.vue:286"),this.value=n.value,i&&(this.getDate(i),e.getStorageSync("userInfo").token&&this.getAssess(i),this.getShopCount()),this.specList.forEach(function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=s.specChildList[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var u=a.value;if(u.pid===e.id){s.$set(u,"selected",!0),s.specSelected.push(u);break}}}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}),t.next=9,this.$api.json("shareList");case 9:this.shareList=t.sent;case 10:case"end":return t.stop()}},t,this)}));function n(e){return t.apply(this,arguments)}return n}(),computed:c({},(0,s.mapState)(["hasLogin","userInfo"])),methods:{getDate:function(){var e=p(a.default.mark(function e(t){var n=this;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.default)({url:"/mobile/get/goods/"+t,method:"get"}).then(function(){var e=p(a.default.mark(function e(i){var s,o,c,l,d,p,h;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n.detailsArr=i.data,"time"!==n.value){e.next=10;break}return n.tip="限时抢购(每天10点开抢)",e.next=5,u.default.get("/goods/limit/time/sku/");case 5:s=e.sent,r("log",s," at pages\\product\\product.vue:329"),200===s.status&&(s.data.active.data.forEach(function(e){e.id+""===t&&(n.detailsArr.price=e.price,n.detailsArr.market_price=e.old_price)}),o=new Date,c=o.getFullYear(),l=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,d=o.getDate()<10?"0"+o.getDate():o.getDate(),p=o.getHours(),o.getMinutes(),o.getSeconds(),h=c+"-"+l+"-"+d+" "+p,r("log",h,s.data.active.start_time," at pages\\product\\product.vue:346"),s.data.active.start_time===h?(n.disabled=!1,n.text="立即开抢"):s.data.active.start_time),r("log",s.data.active.data," at pages\\product\\product.vue:353"),r("log",n.detailsArr," at pages\\product\\product.vue:354");case 10:n.imgList=i.data.images;case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){r("log",e.data," at pages\\product\\product.vue:359")});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),r("error",e.t0," at pages\\product\\product.vue:362");case 8:case"end":return e.stop()}},e,this,[[0,5]])}));function t(t){return e.apply(this,arguments)}return t}(),getAssess:function(){var t=p(a.default.mark(function t(n){var i=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.default)({url:"/goods/comment/?id="+n+"&page_size=5",method:"get",headers:{Authorization:"JWT "+e.getStorageSync("userInfo").token}}).then(function(e){if(200===e.status){i.results=e.data.results;var t=0;i.results.forEach(function(e){t+=1*e.score/5}),i.score=Math.round(t/i.results.length*100)+"%"}}).catch(function(e){r("log",e," at pages\\product\\product.vue:385")});case 2:t.sent;case 3:case"end":return t.stop()}},t,this)}));function n(e){return t.apply(this,arguments)}return n}(),bindChange:function(e){this.count=Number(e),r("log","返回数据",e," at pages\\product\\product.vue:391")},toggleSpec:function(){var e=this;"show"===this.specClass?(this.specClass="hide",setTimeout(function(){e.specClass="none"},250)):"none"===this.specClass&&(this.specClass="show")},toggleJoin:function(){var t=p(a.default.mark(function t(){var n=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.toggleSpec(),t.next=3,(0,u.default)({url:"/cart/",method:"post",data:{sku_id:this.sku_id,count:this.count},headers:{Authorization:"JWT "+e.getStorageSync("userInfo").token},crossDomain:!0,xhrFields:{withCredentials:!0}}).then(function(e){r("log",e.data," at pages\\product\\product.vue:420"),!0===e.data.selected&&(n.$api.msg("加入购物车成功"),n.getShopCount())}).catch(function(e){r("log",e," at pages\\product\\product.vue:426")});case 3:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),getShopCount:function(){var t=p(a.default.mark(function t(){var n=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.default)({url:"/cart/",method:"get",headers:{Authorization:"JWT "+e.getStorageSync("userInfo").token},crossDomain:!0,xhrFields:{withCredentials:!0}}).then(function(e){r("log",e.data," at pages\\product\\product.vue:480"),n.num=e.data.length}).catch(function(e){});case 2:t.sent;case 3:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),toggleBuy:function(){var t=p(a.default.mark(function t(){return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.toggleSpec(),e.getStorageSync("userInfo").token?(this.detailsArr.goods={},e.navigateTo({url:"/pages/order/createOrder?data="+JSON.stringify(this.detailsArr)+"&count="+this.count+"&goods_id="+this.sku_id})):e.navigateTo({url:"/pages/public/login"});case 2:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),selectSpec:function(e,t){var n=this,r=this.specChildList;r.forEach(function(e){e.pid===t&&n.$set(e,"selected",!1)}),this.$set(r[e],"selected",!0),this.specSelected=[],r.forEach(function(e){!0===e.selected&&n.specSelected.push(e)})},share:function(){this.$refs.share.toggleMask()},shareInfo:function(){var t=this,n={href:"http://m.hfyt365.com/#/pages/product/product?id="+this.sku_id,title:"行丰商城",desc:this.detailsArr.name,imgUrl:this.detailsArr.default_image_url},a=[{icon:"/static/sharemenu/wx.png",text:"微信好友"},{icon:"/static/sharemenu/pyq.png",text:"朋友圈"},{icon:"/static/sharemenu/weibo.png",text:"微博"},{icon:"/static/sharemenu/qq.png",text:"QQ"},{icon:"/static/sharemenu/copy.png",text:"复制"},{icon:"/static/sharemenu/more.png",text:"更多"}];this.shareObj=(0,i.default)(n,a,function(t){r("log","点击按钮的序号: "+t," at pages\\product\\product.vue:565");var a={href:n.href||"",title:n.title||"",summary:n.desc||"",success:function(e){r("log","success:"+JSON.stringify(e)," at pages\\product\\product.vue:571")},fail:function(e){r("log","fail:"+JSON.stringify(e)," at pages\\product\\product.vue:574")}};switch(t){case 0:a.provider="weixin",a.scene="WXSceneSession",a.type=0,a.imageUrl=n.imgUrl||"",e.share(a);break;case 1:a.provider="weixin",a.scene="WXSenceTimeline",a.type=0,a.imageUrl=n.imgUrl||"",e.share(a);break;case 2:a.provider="sinaweibo",a.type=0,a.imageUrl=n.imgUrl||"",e.share(a);break;case 3:a.provider="qq",a.type=1,a.imageUrl=n.imgUrl||"",e.share(a);break;case 4:e.setClipboardData({data:n.href,complete:function(){e.showToast({title:"已复制到剪贴板"})}});break;case 5:plus.share.sendWithSystem({type:"web",title:n.title||"",thumbs:[n.imgUrl||""],href:n.href||"",content:n.desc||""});break}}),this.$nextTick(function(){t.shareObj.alphaBg.show(),t.shareObj.shareMenu.show()})},toFavorite:function(){plus.runtime.openURL("http://wpa.qq.com/msgrd?V=1&amp;uin=3145517362&amp;Site=行丰银拓办公用品商城&amp;Menu=yes'")},toCart:function(){e.switchTab({url:"/pages/cart/cart",success:function(){}})},buy:function(){this.toggleSpec(),this.subText="立即购买"},join:function(){this.toggleSpec(),this.subText="加入购物车"},stopPrevent:function(){}}};t.default=m}).call(this,n("6e42")["default"],n("0de9")["default"])},b91e:function(e,t,n){},e63f:function(e,t,n){"use strict";var r={"min-badge":()=>n.e("components/min-badge/min-badge").then(n.bind(null,"ba94")),"uni-number-box":()=>n.e("components/uni-number-box/uni-number-box").then(n.bind(null,"717f"))},a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__map(e.results,function(t,n){var r=t.create_time.split("T"),a=t.create_time.split("T")[1].split(".");return{$orig:e.__get_orig(t),g0:r,g1:a}}));e.$mp.data=Object.assign({},{$root:{l0:n}})},i=[];n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return r})},eae0:function(e,t,n){"use strict";(function(e){n("a8bd"),n("921b");r(n("66fd"));var t=r(n("63cb"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},fdea:function(e,t,n){"use strict";n.r(t);var r=n("717c"),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t["default"]=a.a}},[["eae0","common/runtime","common/vendor"]]]);